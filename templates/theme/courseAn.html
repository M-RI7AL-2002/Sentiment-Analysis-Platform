{%load static%}

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Course Analysis Dashboard</title>

    <link rel="icon" type="image/png" sizes="16x16" href="./images/favicon.png">
    <link rel="stylesheet" href="{%static './vendor/owl-carousel/css/owl.carousel.min.css' %}">
    <link rel="stylesheet" href="{% static './vendor/owl-carousel/css/owl.theme.default.min.css' %}">
    <link href="{% static './vendor/jqvmap/css/jqvmap.min.css' %}" rel="stylesheet">
    <link href="{% static './css/style.css' %}" rel="stylesheet">

    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />

  
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        #map {
            height: 400px; /* Adjust the height as needed */
            width: 100%; /* Full width */
        }
        #searchCourse {
    width: 100%;
    padding: 12px 20px;
    margin-bottom: 20px;
    box-sizing: border-box;
    border: 2px solid #ccc;
    border-radius: 4px;
    font-size: 16px;
}

.table {
    width: 100%;
    border-collapse: collapse;
}

.table th, .table td {
    padding: 12px;
    text-align: left;
    color: black;
    border-bottom: 1px solid #ddd;
}

.table th {
    background-color: #f2f2f2;
}

.table tr:hover {
    background-color: #f5f5f5;
}

.btn-danger {
    color: #fff;
    background-color: #dc3545;
    border-color: #dc3545;
}

.btn-danger:hover {
    color: #fff;
    background-color: #c82333;
    border-color: #bd2130;
}
.col-xl-4, .col-lg-4, .col-md-4 {
            padding: 10px;
        }

        .card {
            background-color: #fff;
            color: #000;
            border: 1px solid #ddd;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .card-body {
            padding: 20px;
            text-align: center;
        }

     
        .form-group {
            margin-bottom: 15px;
            text-align: left;
        }

        .form-group label {
            display: block;
            font-size: 1.2em; /* Larger font size */
            margin-bottom: 5px;
        }

        .form-group input {
            width: 100%;
            padding: 10px;
            font-size: 1.2em; /* Larger font size */
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        .btn-primary {
            background-color: #8000b3;
            border: none;
            padding: 10px 20px;
            font-size: 1.2em; /* Larger font size */
            color: #fff;
            border-radius: 5px;
            cursor: pointer;
        }

        .btn-primary:hover {
            background-color: #8000b3;
        }
    </style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<style>
    body {
        font-family: Arial, sans-serif;
    }

    .col-lg-4 {
        padding: 10px;
    }

    .card {
        background-color: #fff;
        color: #000;
        border: 1px solid #ddd;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
    }

    .card-header {
        background-color: #f5f5f5;
        padding: 10px;
        border-bottom: 1px solid #ddd;
        border-top-left-radius: 10px;
        border-top-right-radius: 10px;
        font-size: 1.5em; /* Larger font size */
        font-weight: bold;
        text-align: center;
    }

    .card-body {
        padding: 20px;
        font-size: 1.2em; /* Larger font size */
    }

    .card-body ul {
        list-style-type: none;
        padding: 0;
    }

    .card-body ul li {
        margin-bottom: 10px;
    }

    .card-body ul li b {
        color: #000;
    }

    .card-title {
        margin: 0;
    }
</style>
</head>

<body>

    <!--*******************
        Preloader start
    ********************-->
    <div id="preloader">
        <div class="sk-three-bounce">
            <div class="sk-child sk-bounce1"></div>
            <div class="sk-child sk-bounce2"></div>
            <div class="sk-child sk-bounce3"></div>
        </div>
    </div>
    <!--*******************
        Preloader end
    ********************-->


    <!--**********************************
        Main wrapper start
    ***********************************-->
    <div id="main-wrapper">

        <!--**********************************
            Nav header start
        ***********************************-->
        <div class="nav-header">
            <a href="{% url 'dashboard' %}" class="brand-logo">
                <img class="logo-abbr" src="{% static 'images/logo.png' %}" alt="">
                <img class="logo-compact" src="{% static 'images/logo-text.png' %}" alt="">
                <img class="brand-title" src="{% static 'images/logo-text.png' %}" alt="">
 
            </a>

            <div class="nav-control">
                <div class="hamburger">
                    <span class="line"></span><span class="line"></span><span class="line"></span>
                </div>
            </div>
        </div>
        <!--**********************************
            Nav header end
        ***********************************-->

        <!--**********************************
            Header start
        ***********************************-->
        <div class="header">
            <div class="header-content">
                <nav class="navbar navbar-expand">
                    <div class="collapse navbar-collapse justify-content-between">
                        <div class="header-left">
                            <div class="search_bar dropdown">
                                <span class="search_icon p-3 c-pointer" data-toggle="dropdown">
                                    
                                </span>
                                <div class="dropdown-menu p-0 m-0">
                                    
                                </div>
                            </div>
                        </div>

                        <ul class="navbar-nav header-right">
                          
                            <li class="nav-item dropdown header-profile">
                                <a class="nav-link" href="#" role="button" data-toggle="dropdown">
                                    <i class="mdi mdi-account"></i>
                                </a>
                                <div class="dropdown-menu dropdown-menu-right">
                                    <a href="{% url 'profile' %}" class="dropdown-item">
                                        <i class="icon-user"></i>
                                        <span class="ml-2">Profile </span>
                                    </a>
                                    
                                    <a href="{% url 'logout' %}" class="dropdown-item">
                                        <i class="icon-key"></i>
                                        <span class="ml-2">Logout </span>
                                    </a>
                                </div>
                            </li>
                        </ul>
                    </div>
                </nav>
            </div>
        </div>
        <!--**********************************
            Header end ti-comment-alt
        ***********************************-->

        <!--**********************************
            Sidebar start
        ***********************************-->
        <div class="quixnav">
            <div class="quixnav-scroll">
                <ul class="metismenu" id="menu">
                    <li class="nav-label first">Main Menu</li>
                    <li><a class="has-arrow" href="javascript:void()" aria-expanded="false"><i
                                class="icon icon-single-04"></i><span class="nav-text">Dashboard</span></a>
                        <ul aria-expanded="false">
                            <li><a href=" {% url 'teacherAn' %} ">Teachers Analytics</a></li>
                            <li><a href="{% url 'courseAn' %}">Courses Analytics</a></li>
                            <li><a href="{% url 'studentAn' %}">Student sentiment Analytics</a></li>
                        </ul>
                    </li>
                    <li class="nav-label">Apps</li>
                    <li><a class="has-arrow" href="javascript:void()" aria-expanded="false"><i
                                class="icon icon-app-store"></i><span class="nav-text">Apps</span></a>
                        <ul aria-expanded="false">
                            <li><a href="{% url 'profile' %}">Profile</a></li>
                            
                            <li><a href="{% url 'todo_list' %}">To do List</a></li>
                        </ul>
                    </li>
                    
                </ul>
            </div>


        </div>
        <!--**********************************
            Sidebar end
        ***********************************-->

        <!--**********************************
            Content body start
        ***********************************-->
        <div class="content-body">
            <!-- row -->
            <div class="container-fluid">
                <div class="row">
                    <div class="col-lg-3 col-sm-6">
                        <div class="card">
                            <div class="stat-widget-two card-body">
                                <div class="stat-content">
                                    <div class="stat-text">Total of Courses </div>
                                    <div class="stat-digit"> {{ total_courses }}</div>
                                </div>
                                <div class="progress">
                                    <div class="progress-bar progress-bar-primary w-75" role="progressbar" aria-valuenow="78" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-sm-6">
                        <div class="card">
                            <div class="stat-widget-two card-body">
                                <div class="stat-content">
                                    <div class="stat-text">Positive Feedback</div>
                                    <div class="stat-digit"> {{ positive_feedback }}</div>
                                </div>
                                <div class="progress">
                                    <div class="progress-bar progress-bar-success w-85" role="progressbar" aria-valuenow="85" aria-valuemin="0" aria-valuemax="100"></div>
                                   
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-sm-6">
                        <div class="card">
                            <div class="stat-widget-two card-body">
                                <div class="stat-content">
                                    <div class="stat-text">Negative Feedbacks</div>
                                    <div class="stat-digit"> {{ negative_feedback }}</div>
                                </div>
                                <div class="progress">
                                    <div class="progress-bar progress-bar-danger w-65" role="progressbar" aria-valuenow="65" aria-valuemin="0" aria-valuemax="100"></div> 
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-sm-6">
                        <div class="card">
                            <div class="stat-widget-two card-body">
                                <div class="stat-content">
                                    <div class="stat-text">Neutral Feedbacks</div>
                                    <div class="stat-digit"> {{ neutral_feedback }}</div>
                                </div>
                                <div class="progress">
                                    <div class="progress-bar progress-bar-warning w-50" role="progressbar" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"></div>
                                  
                                </div>
                            </div>
                        </div>
                        <!-- /# card -->
                    </div>
                    <!-- /# column -->
                </div>
                <div class="row">
                    <div class="col-xl-8 col-lg-8 col-md-8">
                        <div class="card">
                            <div class="card-header">
                                <h4 class="card-title">Feedbacks Overview</h4>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-xl-12 col-lg-8">
                                        <div id="m"><canvas id="sentimentDistribution"></canvas>
                                            <script>
                                                document.addEventListener("DOMContentLoaded", function() {
                                                    var ctx = document.getElementById('sentimentDistribution').getContext('2d');
                                                    var sentimentDistribution = new Chart(ctx, {
                                                        type: 'pie',
                                                        data: {
                                                            labels: ['Positive', 'Neutral', 'Negative'],
                                                            datasets: [{
                                                                data: [{{ positive_feedback }}, {{ neutral_feedback }},{{ negative_feedback }}],
                                                                backgroundColor: ['#4caf50', '#ffeb3b', '#f44336']
                                                            }]
                                                        }
                                                    });
                                                });
                                            </script></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-4 col-lg-4 col-md-4">
                        <div class="card">
                            <div class="card-body text-center">
                                <div class="m-t-10">
                                    <h4 class="card-title">Add Course</h4>
                                    
                                    <form method="post" action="{%url 'add_course' %}">
                                        {% csrf_token %}
                                        <div class="form-group">
                                            <label for="fname">Name</label>
                                            <br>
                                            {{ form.name }}
                                        </div>
                                       
                                        <button type="submit" class="btn btn-primary">Add Course</button>
                                    </form>
                                </div>
                                
                                
                                
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-lg-4">
                        
                            <div class="card">
                                <div class="card-header">Top Rated Courses</div>
                                <div class="card-body">
                                    <ul>
                                        {% for course in top_courses %}
                                             <li><b>-</b>{{ course.course__name }}  ({{ course.count }} positive feedbacks)</li>
                                        {% endfor %}
                                    </ul>
                                </div>
                            </div>
                       
                    </div>
                    <div class="col-lg-4">
                        <div class="card">
                           
                                    <div class="card-header">Bottom Rated Courses</div>
                                    <div class="card-body">
                                        <ul>
                                            {% for course in bottom_courses %}
                                            <li><b>-</b>{{ course.course__name }}  ({{ course.count }} negative feedbacks)</li>
                                            {% endfor %}
                                        </ul>
                                    </div>
                                
                          
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <div class="card">
                            <div class="card-header">
                                <h4 class="card-title">Recent Feedbacks</h4>
                            </div>
                            <div class="card-body">
                                <ul>
                                    {% for feedback in recent_feedback %}
                                    <li><b>-</b>{{ feedback.created_at }} - {{ feedback.course.name }}: {{ feedback.content }} ({{ feedback.sentiment }})</li>
                                    {% endfor %}
                                </ul>
                            </div>
                        </div>
                        <!-- /# card -->
                    </div>
                    
                    

                    <div class="col-xl-8 col-lg-8 col-md-8">
                        <div class="card">
                            <div class="card-header">
                                <h4 class="card-title">Feedbacks Trends Overview</h4>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-xl-12 col-lg-8">
                                        <div id="m">
                                            <canvas id="feedbackTrendsChart"></canvas>
                                            <script>
                                              var ctx2 = document.getElementById('feedbackTrendsChart').getContext('2d');
    var feedbackTrendsChart = new Chart(ctx2, {
        type: 'line',
        data: {
            labels: [
                {% for trend in feedback_trends %}
                    '{{ trend.month }}',
                {% endfor %}
            ],
            datasets: [
                {
                    label: 'Positive',
                    borderColor: '#4CAF50',
                    fill: false,
                    data: [
                        {% for trend in feedback_trends %}
                            {% if trend.sentiment == 'positive' %}
                                {{ trend.count }},
                            {% else %}
                                0,
                            {% endif %}
                        {% endfor %}
                    ]
                },
                {
                    label: 'Neutral',
                    borderColor: '#FFC107',
                    fill: false,
                    data: [
                        {% for trend in feedback_trends %}
                            {% if trend.sentiment == 'neutral' %}
                                {{ trend.count }},
                            {% else %}
                                0,
                            {% endif %}
                        {% endfor %}
                    ]
                },
                {
                    label: 'Negative',
                    borderColor: '#F44336',
                    fill: false,
                    data: [
                        {% for trend in feedback_trends %}
                            {% if trend.sentiment == 'negative' %}
                                {{ trend.count }},
                            {% else %}
                                0,
                            {% endif %}
                        {% endfor %}
                    ]
                }
            ]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    position: 'top',
                },
            }
        }
    });
                                            </script>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-xl-4 col-lg-4 col-md-4">
                        <div class="card">
                            <div class="card-body text-center">
                                <div class="m-t-10">
                                    <input type="text" id="searchCourse" onkeyup="searchFunction('courseTable', 'searchCourse')" placeholder="Search for courses..">
                                    <h4 class="card-title">List of Courses</h4>
                                    <div class="table-responsive">
                                        <table id="courseTable" class="table mb-0">
                                            <thead>
                                                <tr>
                                                    <th>#</th>
                                                    <th>Name</th>
                                                    <th>Action</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {% for course in courses %}
                                                <tr>
                                                    <td>{{ forloop.counter }}</td>
                                                    <td>{{ course.name }}</td>
                                                    <td>
                                                        <form method="post" action="{% url 'delete_course' course.id %}" style="display: inline;">
                                                            {% csrf_token %}
                                                            <button type="submit" class="btn btn-danger btn-sm">Delete</button>
                                                        </form>
                                                    </td>
                                                </tr>
                                                {% empty %}
                                                <tr>
                                                    <td colspan="3">No courses found.</td>
                                                </tr>
                                                {% endfor %}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                
                                <script>
                                function searchFunction(tableId, inputId) {
                                    var input, filter, table, tr, td, i, txtValue;
                                    input = document.getElementById(inputId);
                                    filter = input.value.toUpperCase();
                                    table = document.getElementById(tableId);
                                    tr = table.getElementsByTagName("tr");
                                    for (i = 0; i < tr.length; i++) {
                                        td = tr[i].getElementsByTagName("td")[1]; // Search only in the second column (Name)
                                        if (td) {
                                            txtValue = td.textContent || td.innerText;
                                            if (txtValue.toUpperCase().indexOf(filter) > -1) {
                                                tr[i].style.display = "";
                                            } else {
                                                tr[i].style.display = "none";
                                            }
                                        }
                                    }
                                }
                                </script>
                                
                            </div>
                        </div>
                    </div>
                </div>
                

            </div>
        </div>
        <!--**********************************
            Content body end
        ***********************************-->


        <!--**********************************
            Footer start
        ***********************************-->
        <div class="footer">
            <div class="copyright">
                <p>Copyright Â© Designed &amp; Developed by <a href="#" target="_blank">Richa</a> 2019</p>
            </div>
        </div>
        <!--**********************************
            Footer end
        ***********************************-->

        <!--**********************************
           Support ticket button start
        ***********************************-->

        <!--**********************************
           Support ticket button end
        ***********************************-->


    </div>
    <!--**********************************
        Main wrapper end
    ***********************************-->

    <!--**********************************
        Scripts
    ***********************************-->
    <!-- Required vendors -->
    <script src="{% static './vendor/global/global.min.js' %}"></script>
    <script src="{% static './js/quixnav-init.js' %}"></script>
    <script src="{% static './js/custom.min.js' %}"></script>


    <!-- Vectormap -->
    <script src="{%static './vendor/raphael/raphael.min.js' %}"></script>
    <script src="{%static './vendor/morris/morris.min.js'  %}"></script>


    <script src="{%static './vendor/circle-progress/circle-progress.min.js'%}"></script>
    <script src="{%static './vendor/chart.js/Chart.bundle.min.js' %}"></script>

    <script src="{% static './vendor/gaugeJS/dist/gauge.min.js' %}"></script>

    <!--  flot-chart js -->
    <script src="{% static './vendor/flot/jquery.flot.js' %}"></script>
    <script src="{% static './vendor/flot/jquery.flot.resize.js' %}"></script>

    <!-- Owl Carousel -->
    <script src="{% static './vendor/owl-carousel/js/owl.carousel.min.js' %}"></script>

    <!-- Counter Up -->
    <script src="{% static './vendor/jqvmap/js/jquery.vmap.min.js'%}"></script>
    <script src="{% static './vendor/jqvmap/js/jquery.vmap.usa.js' %}"></script>
    <script src="{% static './vendor/jquery.counterup/jquery.counterup.min.js' %}"></script>


    <script src="{% static './js/dashboard/dashboard-1.js' %}"></script>

</body>

</html>